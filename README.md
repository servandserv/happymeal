# happymeal
xsd2php, xsd2js, wadl2php code generator, happymeal router, happymeal js micro framework

Генерация php кода на основе XML Schemas, WADL описания REST сервисов

1. Генерируются Адаптеры преобразующие  XML данные  в php, js объекты и наоборот.
Генерация производится по схемам данных

2. Генерируется контроллер REST сервиса  на основании WADL. Контроллер использует роутер classes/App.php


Usage: happymeal xsd2code флаги параметры
       happymeal man

Сommand:
  xsd2code Генерация кода классов на основе схем данных и его тестирование.
    Генерация делается в 4 прохода
    а) первым проходом собираем все схемы указанные в параметрах в один файл.
       Добавляем в узлы элементов атрибуты необходимые для построения классов.
       выполняет сборку скрипт 'consolidate_xsd2xml.php' на выходе скрипта
       формируется временный файл '../happymeal_build_tmp/consolidated.xml'
    б) формируем единый файл с кодом путем трансформации
       '../happymeal_build_tmp/consolidated.xml' с использованием xslt шаблонов
       расположенных в файле 'stylesheets/xsd2classes.xsl' на выходе получаем
       временный текстовый файл '../happymeal_build_tmp/classes.txt' который
       содержит php и указатели на файлы классов
    в) парсим полученный текстовый файл '../happymeal_build_tmp/classes.txt' и
       формируем файлы с классами, записываем файлы классов в соответствующие
       папки
    г) из файла '../happymeal_build_tmp/consolidated.xml' путем трансформации
       шаблонами 'stylesheets/xsd2tests.xsl' формируем файл
       '../happymeal_build/xsd2code_tests.php', который содержит исполняемый код
       тестов (пока частично реализованы тесты простых типов). Выполняем
       полученный файл.
    д) если указан флаг j то из файла '../happymeal_build_tmp/consolidated.xml' путем трансформации
       шаблонами 'stylesheets/xsd2js.xsl' формируем js файл который содержит
       код js адабторов к xml и json данным на стороне клиента
       в этот же файл добавляется библиотеки 
        - sax.js (для распарсивания xml документов)
        - Happymeal.js (минифреймворк на клиенте)

  флаги:
    -v
       создание классов валидаторов
    -t 
       создание скрипта тестов сгенерированных классов
    -j 
       создание js адапторов
    -m пространство имен
       задает пространство имен для генерируемых классов.
    -s путь
       путь к папке с файлами схем (по умолчанию ../web/schemas)
    -o путь
       путь к папке с файлами создаваемых классов (по умолчанию ../generated)

  параметры:
    путь [путь ...]
       папки или отдельные файлы схем данных.
       Сссылка на файл дается относительно папки (-s путь)
       например 'ContactsHistory/Event.xsd', или 'ContactsHistory'

  пример:
    happymeal xsd2code -m ARM\\Port\\Adaptor\\Data /ContactsHistory/Event.xsd
       создает классы адапторов данных
    happymeal xsd2code -vtm ARM\\Port\\Adaptor\\Data /ContactsHistory/Event.xsd
       создает классы адапторов, валидаторы к ним и тестовый скрипт.

Command:
    wadl2code Генерируем код скрипта роутера по данным wadl.
        Проверяет все файлы *.wadl в папке (-s путь). Если вторым параметром
        указывается конкретный файл схемы, то генерирует только по нему
        использует для версионности скрипта путь /api/v[0-9]{1,2}\.[0-9]{1,2}
        base ресурсов wadl файла.
        генерируется файл api.v[0-9]{1,2}-[0-9]{1,2}.php в каталоге web

        happymeal wadl2code  -o path/to/destination -s path/to/schemas  -m \\\\Namespace\\\\Port\\\\Adaptor\\\\Data schema_catalog
    
Command:
  man   Мануал

Сommand:[todo]
  init  Инициализация happymeal в рабочем проекте.

